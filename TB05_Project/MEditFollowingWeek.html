<!DOCTYPE html>
<html lang="en">
<head>
    <link href="TB05css.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Comfortaa:wght@300..700&display=swap" rel="stylesheet">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Assigned Shifts</title>
</head>
<body>
    <header>
        <h1>Edit Assigned Shifts</h1>
    </header>

    <!-- Container for editing schedule -->
    <div id="editSchedule"></div>

    <!-- Save and Back buttons -->
    <button id="saveChanges" class="extraBtns">Save Changes</button>
    <a href="MFollowingWeek.html"><button class="extraBtns">Back to Schedule</button></a>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const scheduleContainer = document.getElementById('editSchedule');
            const assignedShifts = JSON.parse(localStorage.getItem('assignedShifts')) || [];
            const volunteers = JSON.parse(localStorage.getItem('volunteers')) || [];

            // Extract volunteer names for the dropdown
            const volunteerNames = volunteers.map(v => v.name);

            // Display editable schedule
            scheduleContainer.innerHTML = '<h3>Edit Volunteers for Shifts</h3>';
            assignedShifts.forEach((shift, index) => {
                const shiftDiv = document.createElement('div');
                shiftDiv.innerHTML = `
                    <p><strong>Day:</strong> ${shift.day} <strong>Time:</strong> ${shift.time} <strong>Role:</strong> ${shift.role}</p>
                    <label for="volunteer-${index}">Assigned Volunteer:</label>
                    <select id="volunteer-${index}" data-index="${index}">
                        <option value="Unassigned">Unassigned</option>
                        ${volunteerNames.map(name => `
                            <option value="${name}" ${shift.volunteer === name ? 'selected' : ''}>${name}</option>
                        `).join('')}
                    </select>
                `;
                scheduleContainer.appendChild(shiftDiv);
            });

            // Save changes to localStorage
            document.getElementById('saveChanges').addEventListener('click', () => {
                const updatedShifts = assignedShifts.map((shift, index) => {
                    const select = document.querySelector(`#volunteer-${index}`);
                    shift.volunteer = select.value;
                    return shift;
                });

                localStorage.setItem('assignedShifts', JSON.stringify(updatedShifts));
                alert('Schedule updated successfully!');
            });
        });
    </script>
</body>
</html>